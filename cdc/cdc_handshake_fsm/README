This is an interview question at Microsoft. Frankly speaking, I do not think this should be asked as an interview question: if you have done it before, you will be able to give the answer in one minute, but if you not, then you won't be able to make it in one hour. This quesiton is not to evaluate your thinking, but just experience.

I have the routine combinational solution in other folder, and I give the FSM solution, which is more easy to read here.